<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Happy New Year 2026</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  background: black;
  overflow: hidden;
}
canvas {
  display: block;
}
</style>
</head>
<body>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let w, h;
function resize() {
  const dpr = window.devicePixelRatio || 1;
  canvas.width  = window.innerWidth * dpr;
  canvas.height = window.innerHeight * dpr;
  canvas.style.width  = window.innerWidth + "px";
  canvas.style.height = window.innerHeight + "px";
  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  w = window.innerWidth;
  h = window.innerHeight;
}

window.addEventListener("resize", resize);
resize();

const message = "Happy New Year 2026";
let charIndex = 0;

function charPoints(char, size) {
  const off = document.createElement("canvas");
  const octx = off.getContext("2d");

  off.width = size * 2;
  off.height = size * 2;

  octx.fillStyle = "white";
  octx.textAlign = "center";
  octx.textBaseline = "middle";
  octx.font = `bold ${size}px Segoe UI`;
  octx.fillText(char, off.width / 2, off.height / 2);

  const img = octx.getImageData(0, 0, off.width, off.height).data;
  const pts = [];

  for (let y = 0; y < off.height; y += 4) {
    for (let x = 0; x < off.width; x += 4) {
      if (img[(y * off.width + x) * 4 + 3] > 128) {
        pts.push({ x, y });
      }
    }
  }
  return pts;
}

let fireworks = [];

function launchNext() {
  const char = message[charIndex];
  const isLastChar = charIndex === message.length - 1;

  charIndex = (charIndex + 1) % message.length;

  if (char !== " ") {
    const size = Math.min(w, h) / 6;

    fireworks.push({
      pts: charPoints(char, size),
      sparks: Array.from({ length: 80 }, () => {
        const a = Math.random() * Math.PI * 2;
        const s = Math.random() * 4 + 2;
        return {
          vx: Math.cos(a) * s,
          vy: Math.sin(a) * s
        };
      }),
      x: Math.random() * w * 0.6 + w * 0.2,
      targetY: h * 0.4,
      t: 0
    });
  }


  const nextDelay = isLastChar ? 2000 : 450;
  setTimeout(launchNext, nextDelay);
}


launchNext();


function animate() {
  ctx.fillStyle = "rgba(0,0,0,0.25)";
  ctx.fillRect(0, 0, w, h);

  fireworks.forEach((f, fi) => {
    f.t += 0.03;

    if (f.t < 1) {
      ctx.fillStyle = "white";
      ctx.beginPath();
      ctx.arc(f.x, h - (h - f.targetY) * f.t, 2, 0, Math.PI * 2);
      ctx.fill();
    } else {
      const p = f.t - 1;

      f.sparks.forEach(s => {
        ctx.fillStyle = `hsla(${Date.now() / 30 % 360},100%,60%,${1 - p})`;
        ctx.beginPath();
        ctx.arc(
          f.x + s.vx * p * 20,
          f.targetY + s.vy * p * 20,
          2,
          0,
          Math.PI * 2
        );
        ctx.fill();
      });

      f.pts.forEach(pt => {
        const dx = pt.x - Math.min(w, h) / 6;
        const dy = pt.y - Math.min(w, h) / 6;

        ctx.fillStyle = `hsla(${(dx + Date.now() / 20) % 360},100%,70%,0.9)`;
        ctx.beginPath();
        ctx.arc(
          f.x + dx * 0.6,
          f.targetY + dy * 0.6,
          2,
          0,
          Math.PI * 2
        );
        ctx.fill();
      });

      if (f.t > 1.8) {
        fireworks.splice(fi, 1);
      }
    }
  });

  requestAnimationFrame(animate);
}

animate();
</script>

</body>
</html>
